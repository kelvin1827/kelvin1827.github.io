# 用户手册

For 制品库存管理目视化系统 `Version` `0.8.x`
Last updated by `LIUKAI` at `2019/4/28`

---

## 目录

* [系统概要](#系统概要)
* [实际操作](#实际操作)
  * [数据汲取](#数据汲取)
  * [数据入库](#数据入库)
  * [生成图表](#生成图表)

---

## 制品库存管理目视化系统  {#系统概要}

### 系统目的

通过获取品番别的**生成计划**、**生成日报**以及**销售出库**的信息，自动记录、计算各品番的库存数量，并通过图表的形式，输出相应品番的**库存变动**情况的自动化系统。

### 系统构成

#### 1. 系统**总体构成**表

系统由如下表所示的**文件夹**及**文件**所构成。

|No|构成名称|文件类型|作用|
|---:|---|---|---|
|1|`00_Database`|文件夹|存放**数据库**文件|
|2|`01_Before`|文件夹|存放==待提取==信息<br>的`Excel`文件|
|3|`10_NeedCheck`|文件夹|存放提取信息时<br>发生==错误==，待确认<br>的`Excel`文件|
|4|`11_Planing`|文件夹|存放信息提取成功<br>的**生产计划**文件|
|5|`11_Production`|文件夹|存放信息提取成功<br>的**生产日报**文件|
|6|`11_Shipped`|文件夹|存放信息提取成功<br>的**销售出库**文件|
|7|`综合管理面板.xlsm`|`Excel`文件|存放程序主体的<br>主控`Excel`文件|

#### 2. **主控文件**构成表

下记是主控制文件`综合管理面板.xlsm`中不可或缺的三个工作表`Worksheet`。

|No|表名称|说明|
|---:|---|---|
|1|`main`|主控制面板所在表|
|2|`db_io`|数据暂存表，用于存放<br>从计划、生产、出库等<br>`Excel`表中提取的数据。<br>数据库**经由此表**获取数据 |
|3|`logs`|记录读取到的各`Excel`表<br>名称、时间、获取的数据量<br>及是否发生错误的信息表|

> 每次启动主控文件时，系统将自动确认主控文件中是否存在这三个表。
> 如发现有缺失，系统会自动生成相应的表。

---

## 实际操作 {#实际操作}

### 数据汲取 {#数据汲取}

* #### 生产计划文件

##### `Step1`

将**生产计划**文件复制到`01Before`文件夹中。

##### `Step2`

打开`V0.8.9综合管理面板.xlsm`文件，定位到`main`工作表。

##### `Step3`

在点击`数据汲取`按钮之前，请留意以下内容。

1. 请打开**生产计划**文件，确认已选中`生产日计划`工作表。
2. 确认`生产日计划`工作表中以下各区域的内容：

| No | 单元格/列 | 内容 | 备注 |
|---:|:---:|---|---|
|1| `A1`|生产日计划|表单类型识别用|
|2|`B` 列|零件号|须为完整12位|
|3|`N` 列|班次`A`产量|必须为数字|
|4|`O2`|`A`班计划日期|须为日期格式|
|5|`R2`|班次信息：`A`|不可合并|
|6|`T` 列|班次`B`产量|必须为数字|
|7|`U2`|`B`班计划日期|须为日期格式|
|8|`X2`|班次信息：`B`|不可合并|

3. 确认以上内容无误之后，**保存并关闭**文件。

##### `Step4`

点击`main`工作表中的`数据汲取`按钮，启动数据搜集程序。

数据读取成功后

**生产计划**文件将被重新命名，并移动到`11Planning`文件夹。
   * 如表头有问题，弹出**表头有误**提示对话框，停止执行程序，文件保留在原处。
  * 如发生其他问题，**生产计划**文件将被==重新命名==并移动至`10NeedCheck`文件夹。

* #### 生产日报文件

##### `Step1`

将**生产日报**文件复制到`01Before`文件夹中。

##### `Step2`

打开`V0.8.9综合管理面板.xlsm`文件，定位到`main`工作表。

##### `Step3`

在点击`数据汲取`按钮之前，请留意以下内容。

1. 请打开**生产日报**文件，确认已选中`日明细`工作表。
2. 确认`日明细`工作表中以下各区域的内容：

| No | 单元格/列 | 内容 | 备注 |
|---:|:---:|---|---|
|1|`A` 列|读取日期|==自动记入==|
|2|`B` 列|生产日期|人工记入|
|3|`S` 列|合格数|必须为数字|
|4|`F2`|班次信息：<br>`A`或者`B`|不可合并|

3. 确认以上内容无误之后，**保存并关闭**文件。

##### `Step4`

点击`main`工作表中的`数据汲取`按钮，启动数据搜集程序。

> 读取成功后文件保留在原处。
> * 如读取不成功，**生产日报**文件将被==重新命名==并移动至`10NeedCheck`文件夹。

---

### 数据入库 {#数据入库}

点击`数据入库`按钮，系统会将通过数据汲取操作读取到`DB_io`工作表中的数据，写入位于`00_Database`文件夹中的数据库中。

---

### 生成图表

#### 准备生成所须的图表

##### `Step1`



---

&copy; `LIUKAI` `2019`